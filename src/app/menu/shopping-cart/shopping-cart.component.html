<div class="wrapper">
  <div
    class="page-header page-header-xs"
    data-parallax="true"
    style="background-image: url('./assets/img/vegetable.jpg')"
  >
    <div class="filter"></div>
  </div>

  <div class="section">
    <div class="container">
      <div class="owner">
        <h2 class="title">Carro de compras</h2>
        <blockquote class="blockquote">
          <p class="mb-2 text-center">
            Recuerda que por ley el municipio de Sibaté no puede administrar
            dinero de compras, por lo cual aquí puedes crear tu pedido, y
            posteriormente el vendedor se encargara de contactarte para
            organizar la entrega y el pago.
          </p>
        </blockquote>
        <hr />
        <section>
          <div class="spacer">
            <div class="container">
              <div class="row mt-5">
                <div class="col-lg-12">
                  <div class="row shop-listing">
                    <table class="table">
                      <thead>
                        <tr>
                          <th class="b-0">Producto</th>
                          <th class="b-0">Nombre</th>
                          <th class="b-0">Precio unitario</th>
                          <th class="b-0">Cantidad</th>
                          <th class="b-0">Total</th>
                          <th class="b-0">Eliminar</th>
                        </tr>
                      </thead>

                      <tbody>
                        <tr *ngFor="let product of products$ | async">
                          <td data-label = "Producto" class="order-info">
                            <img
                              src="{{ product.product.images[0].url }}"
                              class="img-fluid rounded shadow-sm"
                              width="90"
                              alt="{{ product.product.name }}"
                            />
                          </td>
                          <td data-label = "Nombre" class="order-info">{{ product.product.name }}</td>
                          <td data-label = "Precio unitario" class="order-info">{{ product.product.unitaryPrice | currency }}</td>
                          <td data-label = "Cantidad" class="order-info">
                            <button
                              class="btn btn-primary btn-sm"
                              (click)="susbtractQuantity(product)"
                            >
                              -
                            </button>
                            {{ product.quantity }}
                            {{ product.product.unit }}
                            <button
                              class="btn btn-primary btn-sm"
                              (click)="addQuantity(product)"
                            >
                              +
                            </button>
                          </td>
                          <td data-label = "Total" class="order-info">
                            {{ product.price | currency }}
                          </td>
                          <td data-label = "Eliminar" class="order-info">
                            <button
                              class="btn btn-danger btn-sm"
                              (click)="removeFromCart(product)"
                            >
                              <i class="nc-icon nc-simple-remove"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                      <tr>
                        <td colspan="5" align="right">
                          Subtotal : {{ subTotalPrice | currency }}
                        </td>
                        <td colspan="4" align="right">
                          <button
                            class="btn btn-success"
                            (click)="createOrder()"
                          >
                            Crear pedido
                          </button>
                        </td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</div>
